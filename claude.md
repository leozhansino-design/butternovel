# ğŸ¦‹ ButterNovel - Claude å¼€å‘å‚è€ƒæ–‡æ¡£

> **å¿«é€Ÿå‚è€ƒ**: æ¯æ¬¡å¼€å‘å‰å¿…è¯»,å¸®åŠ© Claude å¿«é€Ÿç†è§£é¡¹ç›®ä¸Šä¸‹æ–‡

**æœ€åæ›´æ–°**: 2025-11-16
**é¡¹ç›®ç‰ˆæœ¬**: MVP v1.1 (æ€§èƒ½ä¼˜åŒ–å®Œæˆ)
**Redisä¼˜åŒ–**: ä½¿ç”¨é‡é™ä½91% âœ…

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆ](#2-æŠ€æœ¯æ ˆ)
3. [é¡¹ç›®ç»“æ„](#3-é¡¹ç›®ç»“æ„)
4. [æ•°æ®åº“è®¾è®¡](#4-æ•°æ®åº“è®¾è®¡)
5. [å¼€å‘è§„èŒƒ](#5-å¼€å‘è§„èŒƒ)
6. [API è·¯ç”±](#6-api-è·¯ç”±)
7. [æ ¸å¿ƒåŠŸèƒ½æ¨¡å—](#7-æ ¸å¿ƒåŠŸèƒ½æ¨¡å—)
8. [ç¼“å­˜ç­–ç•¥](#8-ç¼“å­˜ç­–ç•¥) â­ NEW!
9. [å¸¸è§ä»»åŠ¡å‚è€ƒ](#9-å¸¸è§ä»»åŠ¡å‚è€ƒ)
10. [ç¯å¢ƒå˜é‡](#10-ç¯å¢ƒå˜é‡)
11. [å·²å®ŒæˆåŠŸèƒ½](#11-å·²å®ŒæˆåŠŸèƒ½)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®å®šä½

**ButterNovel** æ˜¯ä¸€ä¸ªå…è´¹çŸ­ç¯‡å°è¯´é˜…è¯»å¹³å°,é›†æˆäº†é˜…è¯»ã€åˆ›ä½œå’Œç¤¾åŒºäº’åŠ¨åŠŸèƒ½ã€‚

**æ ¸å¿ƒç‰¹å¾**:
- å…è´¹çŸ­ç¯‡å°è¯´ (5,000-20,000 å­—)
- ç§»åŠ¨ä¼˜å…ˆè®¾è®¡
- ç”¨æˆ·æ—¢æ˜¯è¯»è€…ä¹Ÿå¯ä»¥æˆä¸ºä½œå®¶
- ç®¡ç†å‘˜åå°ç®¡ç†æ‰€æœ‰å†…å®¹

**ä¸‰ç§è§’è‰²**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯»è€… (é»˜è®¤)                             â”‚
â”‚ - æµè§ˆ/æœç´¢å°è¯´                         â”‚
â”‚ - é˜…è¯»å°è¯´                              â”‚
â”‚ - ç®¡ç†ä¹¦æ¶                              â”‚
â”‚ - ç‚¹èµ/è¯„è®º                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä½œå®¶ (åæœŸåŠŸèƒ½)                         â”‚
â”‚ - åˆ›å»º/ç¼–è¾‘å°è¯´                         â”‚
â”‚ - ç®¡ç†ç« èŠ‚                              â”‚
â”‚ - æŸ¥çœ‹ç»Ÿè®¡æ•°æ®                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç®¡ç†å‘˜ (ç‹¬ç«‹åå°)                       â”‚
â”‚ - æœç´¢/ç¼–è¾‘æ‰€æœ‰å°è¯´                     â”‚
â”‚ - ä¸Šä¼ å°è¯´                              â”‚
â”‚ - ç®¡ç†ç« èŠ‚                              â”‚
â”‚ - å°ç¦å†…å®¹                              â”‚
â”‚ - ç”¨æˆ·ç®¡ç†                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 äº§å“ç‰¹è‰²

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **å†…å®¹é•¿åº¦** | 5,000-20,000 å­—å®Œæ•´çŸ­ç¯‡ |
| **å•†ä¸šæ¨¡å¼** | å®Œå…¨å…è´¹ (æœªæ¥å¹¿å‘Šå˜ç°) |
| **è®¾è®¡ç†å¿µ** | ç§»åŠ¨ä¼˜å…ˆ (Mobile First) |
| **ç”¨æˆ·èº«ä»½** | ä¸€ä¸ªè´¦å·,å¤šç§è§’è‰² |
| **æ•°æ®è¿½è¸ª** | é˜…è¯»è¿›åº¦è‡ªåŠ¨ä¿å­˜ |

---

## 2. æŠ€æœ¯æ ˆ

### 2.1 æ ¸å¿ƒæŠ€æœ¯

```json
{
  "å‰ç«¯æ¡†æ¶": "Next.js 16 (App Router)",
  "Reactç‰ˆæœ¬": "19.2.0",
  "UIæ¡†æ¶": "Tailwind CSS 4",
  "å›¾æ ‡åº“": "Lucide React",
  "æ•°æ®åº“": "Vercel Postgres (é€šè¿‡ Prisma ORM)",
  "èº«ä»½éªŒè¯": "NextAuth.js v5",
  "å›¾ç‰‡å­˜å‚¨": "Cloudinary",
  "è¡¨å•å¤„ç†": "React Hook Form + Zod",
  "å›¾è¡¨": "Recharts",
  "éƒ¨ç½²å¹³å°": "Vercel"
}
```

### 2.2 å…³é”®ä¾èµ–

```json
{
  "dependencies": {
    "next": "16.0.1",
    "react": "19.2.0",
    "@prisma/client": "^6.18.0",
    "next-auth": "^5.0.0-beta.30",
    "cloudinary": "^2.8.0",
    "react-hook-form": "^7.66.0",
    "zod": "^4.1.12",
    "bcryptjs": "^3.0.3",
    "use-debounce": "^10.0.0"
  }
}
```

### 2.3 å¼€å‘å‘½ä»¤

```bash
npm run dev              # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build            # ç”Ÿäº§ç¯å¢ƒæ„å»º
npm run db:generate      # ç”Ÿæˆ Prisma Client
npm run db:push          # æ¨é€æ•°æ®åº“ schema
npm run db:seed          # ç§å­åˆ†ç±»æ•°æ®
npm run db:seed-admin    # åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·
npm run db:studio        # æ‰“å¼€ Prisma Studio
```

---

## 3. é¡¹ç›®ç»“æ„

### 3.1 å®Œæ•´ç›®å½•æ ‘

```
butternovel/
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma          # æ•°æ®åº“ Schema
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ seed-categories.ts     # åˆ†ç±»ç§å­æ•°æ®
â”‚   â””â”€â”€ seed-admin-user.ts     # ç®¡ç†å‘˜è´¦æˆ·åˆ›å»º
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                   # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ page.tsx           # é¦–é¡µ (/)
â”‚   â”‚   â”œâ”€â”€ layout.tsx         # æ ¹å¸ƒå±€
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ auth/              # ç”¨æˆ·è®¤è¯
â”‚   â”‚   â”‚   â”œâ”€â”€ login/page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ register/page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ novels/            # å°è¯´æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ [slug]/page.tsx                    # å°è¯´è¯¦æƒ…
â”‚   â”‚   â”‚   â””â”€â”€ [slug]/chapters/[number]/page.tsx  # ç« èŠ‚é˜…è¯»å™¨
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ admin/             # ç®¡ç†å‘˜åå°
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx       # Dashboard
â”‚   â”‚   â”‚   â”œâ”€â”€ profile/page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ novels/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx   # å°è¯´åˆ—è¡¨ (å¸¦æœç´¢)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ new/page.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ edit/page.tsx
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ chapters/
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ new/page.tsx
â”‚   â”‚   â”‚   â”‚           â””â”€â”€ [chapterId]/Edit/page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ admin-login/       # ç®¡ç†å‘˜ç™»å½•
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ api/               # API Routes
â”‚   â”‚       â”œâ”€â”€ auth/
â”‚   â”‚       â”œâ”€â”€ admin/
â”‚   â”‚       â”œâ”€â”€ library/
â”‚   â”‚       â”œâ”€â”€ profile/
â”‚   â”‚       â”œâ”€â”€ views/
â”‚   â”‚       â””â”€â”€ reading-progress/
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ shared/            # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Footer.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Toast.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ LibraryModal.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ LoginModal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ UserMenu.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ admin/             # ç®¡ç†å‘˜ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ AdminHeader.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AdminSidebar.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ NovelSearchBar.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ NovelUploadForm.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ EditNovelForm.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ChapterAddForm.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ChapterEditForm.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AdminProfileForm.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AvatarCropper.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ BanButton.tsx
â”‚   â”‚   â”‚   â””â”€â”€ StatsCard.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ front/             # å‰å°ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ BookCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CategorySection.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ FeaturedCarousel.tsx
â”‚   â”‚   â”‚   â””â”€â”€ NovelCover.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ library/           # ä¹¦æ¶ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ MyLibrary.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ LibrarySidebar.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ProfileView.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ reader/            # é˜…è¯»å™¨ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ ChapterReader.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ novel/             # å°è¯´ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ AddToLibraryButton.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ auth/              # è®¤è¯ç»„ä»¶
â”‚   â”‚       â””â”€â”€ AuthModal.tsx
â”‚   â”‚
â”‚   â””â”€â”€ lib/                   # å·¥å…·åº“
â”‚       â”œâ”€â”€ prisma.ts          # Prisma å®¢æˆ·ç«¯
â”‚       â”œâ”€â”€ auth.ts            # NextAuth é…ç½®
â”‚       â”œâ”€â”€ admin-auth.ts      # ç®¡ç†å‘˜è®¤è¯
â”‚       â”œâ”€â”€ cloudinary.ts      # Cloudinary é…ç½®
â”‚       â”œâ”€â”€ format.ts          # æ ¼å¼åŒ–å·¥å…·
â”‚       â”œâ”€â”€ utils.ts           # é€šç”¨å·¥å…·
â”‚       â”œâ”€â”€ validate-env.ts    # ç¯å¢ƒå˜é‡éªŒè¯
â”‚       â””â”€â”€ view-tracker.ts    # æµè§ˆé‡è¿½è¸ª
â”‚
â”œâ”€â”€ types/
â”‚   â””â”€â”€ next-auth.d.ts         # NextAuth ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ README.md                  # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ claude.md                  # æœ¬æ–‡ä»¶ (Claude å‚è€ƒ)
â””â”€â”€ .env.local                 # ç¯å¢ƒå˜é‡ (ä¸æäº¤)
```

### 3.2 é‡è¦æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶è·¯å¾„ | ç”¨é€” |
|---------|------|
| `src/lib/prisma.ts` | Prisma å®¢æˆ·ç«¯å•ä¾‹ |
| `src/lib/auth.ts` | NextAuth ç”¨æˆ·è®¤è¯é…ç½® |
| `src/lib/admin-auth.ts` | ç®¡ç†å‘˜è®¤è¯å·¥å…· |
| `prisma/schema.prisma` | æ•°æ®åº“ Schema å®šä¹‰ |
| `src/app/api/admin/` | ç®¡ç†å‘˜ API è·¯ç”± |
| `src/components/admin/` | ç®¡ç†å‘˜ç»„ä»¶ |

---

## 4. æ•°æ®åº“è®¾è®¡

### 4.1 æ ¸å¿ƒè¡¨ç»“æ„

#### User (ç”¨æˆ·è¡¨)
```prisma
model User {
  id              String   @id @default(cuid())
  email           String   @unique
  password        String?
  name            String?
  avatar          String?
  avatarPublicId  String?  // Cloudinary Public ID
  bio             String?
  role            String   @default("USER")

  // OAuth
  googleId        String?  @unique
  facebookId      String?  @unique

  // ä½œå®¶ä¿¡æ¯ (åæœŸ)
  isWriter        Boolean  @default(false)
  writerName      String?
  writerBio       String?

  // çŠ¶æ€
  isVerified      Boolean  @default(false)
  isActive        Boolean  @default(true)
  isBanned        Boolean  @default(false)

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // å…³ç³»
  library         Library[]
  readingHistory  ReadingHistory[]
  likes           NovelLike[]
  chapterProgress ChapterProgress[]
  comments        Comment[]
}
```

#### Novel (å°è¯´è¡¨)
```prisma
model Novel {
  id                  Int         @id @default(autoincrement())
  title               String
  slug                String      @unique
  coverImage          String
  coverImagePublicId  String?     // Cloudinary Public ID
  blurb               String      @db.Text

  // ä½œè€…
  authorId            String
  authorName          String      @default("ButterNovel Official")

  // åˆ†ç±»
  categoryId          Int
  category            Category    @relation(fields: [categoryId], references: [id])

  // çŠ¶æ€
  status              NovelStatus @default(ONGOING)
  isPublished         Boolean     @default(false)
  isDraft             Boolean     @default(true)

  // å®¡æ ¸
  isApproved          Boolean     @default(true)
  reviewNote          String?     @db.Text

  // å°ç¦åŠŸèƒ½
  isBanned            Boolean     @default(false)
  bannedUntil         DateTime?
  banReason           String?     @db.Text

  // ç»Ÿè®¡
  totalChapters       Int         @default(0)
  wordCount           Int         @default(0)
  viewCount           Int         @default(0)
  likeCount           Int         @default(0)
  commentCount        Int         @default(0)

  createdAt           DateTime    @default(now())
  updatedAt           DateTime    @updatedAt
  publishedAt         DateTime?

  // å…³ç³»
  chapters            Chapter[]
  library             Library[]
  readingHistory      ReadingHistory[]
  likes               NovelLike[]
  comments            Comment[]
  views               NovelView[]
}

enum NovelStatus {
  ONGOING
  COMPLETED
}
```

#### Chapter (ç« èŠ‚è¡¨)
```prisma
model Chapter {
  id            Int      @id @default(autoincrement())
  novelId       Int
  novel         Novel    @relation(fields: [novelId], references: [id], onDelete: Cascade)

  chapterNumber Int
  title         String
  slug          String
  content       String   @db.Text
  wordCount     Int      @default(0)
  isPublished   Boolean  @default(true)

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  // å…³ç³»
  readingHistory  ReadingHistory[]
  chapterProgress ChapterProgress[]

  @@unique([novelId, chapterNumber])
  @@index([novelId, isPublished, chapterNumber])
}
```

#### Category (åˆ†ç±»è¡¨)
```prisma
model Category {
  id     Int      @id @default(autoincrement())
  name   String   @unique
  slug   String   @unique
  icon   String?
  order  Int      @default(0)
  novels Novel[]
}
```

#### Library (ä¹¦æ¶è¡¨)
```prisma
model Library {
  id      String   @id @default(cuid())
  userId  String
  user    User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  novelId Int
  novel   Novel    @relation(fields: [novelId], references: [id], onDelete: Cascade)
  addedAt DateTime @default(now())

  @@unique([userId, novelId])
}
```

#### ReadingHistory (é˜…è¯»å†å²)
```prisma
model ReadingHistory {
  id         String   @id @default(cuid())
  userId     String
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  novelId    Int
  novel      Novel    @relation(fields: [novelId], references: [id], onDelete: Cascade)
  chapterId  Int
  chapter    Chapter  @relation(fields: [chapterId], references: [id], onDelete: Cascade)
  lastReadAt DateTime @default(now())

  @@unique([userId, novelId])
}
```

#### ChapterProgress (ç« èŠ‚é˜…è¯»è¿›åº¦)
```prisma
model ChapterProgress {
  id             String   @id @default(cuid())
  userId         String
  chapterId      Int
  scrollPosition Int      @default(0)
  percentage     Int      @default(0)
  isCompleted    Boolean  @default(false)
  updatedAt      DateTime @updatedAt

  @@unique([userId, chapterId])
}
```

#### NovelView (æµè§ˆè®°å½•)
```prisma
model NovelView {
  id        Int      @id @default(autoincrement())
  novelId   Int
  novel     Novel    @relation(fields: [novelId], references: [id], onDelete: Cascade)

  userId    String?
  guestId   String?  // æ¸¸å®¢æ ‡è¯†

  ipAddress String?
  userAgent String?  @db.Text
  viewedAt  DateTime @default(now())
}
```

#### Admin (ç®¡ç†å‘˜è¡¨)
```prisma
model Admin {
  id       String    @id @default(cuid())
  email    String    @unique
  password String
  name     String
  role     AdminRole @default(MODERATOR)
  isActive Boolean   @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum AdminRole {
  SUPER_ADMIN
  ADMIN
  MODERATOR
}
```

#### AdminProfile (ç®¡ç†å‘˜æ¡£æ¡ˆ)
```prisma
model AdminProfile {
  id          Int      @id @default(autoincrement())
  email       String   @unique
  displayName String   @default("Admin")
  bio         String?  @db.Text
  avatar      String?  @db.Text  // Base64 ç¼–ç åœ†å½¢å¤´åƒ

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
```

### 4.2 å…³ç³»å›¾

```
User â”€â”€â”¬â”€â”€ Library (å¤šå¯¹å¤š via Library) â”€â”€â”€ Novel
       â”œâ”€â”€ ReadingHistory â”€â”€â”€ Novel
       â”œâ”€â”€ ChapterProgress â”€â”€â”€ Chapter
       â”œâ”€â”€ NovelLike â”€â”€â”€ Novel
       â””â”€â”€ Comment â”€â”€â”€ Novel

Novel â”€â”€â”¬â”€â”€ Chapter (ä¸€å¯¹å¤š)
        â”œâ”€â”€ Category (å¤šå¯¹ä¸€)
        â”œâ”€â”€ Library
        â”œâ”€â”€ ReadingHistory
        â”œâ”€â”€ NovelLike
        â”œâ”€â”€ Comment
        â””â”€â”€ NovelView

Admin (ç‹¬ç«‹è¡¨,æ— å…³è”)
AdminProfile (ç‹¬ç«‹è¡¨,é€šè¿‡ email å…³è” Admin)
```

---

## 5. å¼€å‘è§„èŒƒ

### 5.1 ä»£ç è§„èŒƒ

**å‘½åçº¦å®š**:
- ç»„ä»¶: PascalCase (`BookCard.tsx`)
- å·¥å…·å‡½æ•°: camelCase (`formatDate()`)
- å¸¸é‡: UPPER_SNAKE_CASE (`API_URL`)
- æ–‡ä»¶: kebab-case (page.tsx, layout.tsx)

**ç»„ä»¶ç»“æ„**:
```typescript
// 1. å¯¼å…¥
import { ... } from '...'

// 2. ç±»å‹å®šä¹‰
type Props = { ... }

// 3. ä¸»ç»„ä»¶
export default function Component({ ... }: Props) {
  // çŠ¶æ€
  const [state, setState] = useState()

  // å‡½æ•°
  const handleAction = () => { ... }

  // æ¸²æŸ“
  return <div>...</div>
}
```

**Server Actions çº¦å®š**:
- æ€»æ˜¯æ ‡è®° `'use server'`
- è¿”å› `{ success: boolean, data?: any, error?: string }`
- é”™è¯¯å¤„ç†ç”¨ try-catch

**API è·¯ç”±çº¦å®š**:
- ä½¿ç”¨ `NextResponse`
- ç»Ÿä¸€é”™è¯¯å¤„ç†æ ¼å¼
- ç®¡ç†å‘˜ API éœ€è¦è®¤è¯æ£€æŸ¥

### 5.2 æ–‡ä»¶å‘½åè§„èŒƒ

| ç±»å‹ | å‘½å | ç¤ºä¾‹ |
|------|------|------|
| é¡µé¢ | `page.tsx` | `app/admin/page.tsx` |
| å¸ƒå±€ | `layout.tsx` | `app/admin/layout.tsx` |
| åŠ è½½çŠ¶æ€ | `loading.tsx` | `app/novels/[slug]/loading.tsx` |
| 404é¡µé¢ | `not-found.tsx` | `app/novels/[slug]/not-found.tsx` |
| APIè·¯ç”± | `route.ts` | `app/api/admin/novels/route.ts` |
| ç»„ä»¶ | `PascalCase.tsx` | `BookCard.tsx` |
| å·¥å…· | `kebab-case.ts` | `view-tracker.ts` |

### 5.3 Git æäº¤è§„èŒƒ

```bash
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤ bug
refactor: é‡æ„
docs: æ–‡æ¡£æ›´æ–°
style: æ ·å¼è°ƒæ•´
perf: æ€§èƒ½ä¼˜åŒ–
test: æµ‹è¯•
chore: æ„å»º/é…ç½®
```

**ç¤ºä¾‹**:
```bash
git commit -m "feat: Library Modal é‡æ„ + å¤´åƒä¸Šä¼  + é˜…è¯»è¿›åº¦è¿½è¸ª"
git commit -m "fix: ä¿®å¤ç®¡ç†å‘˜ç™»å½• session é—®é¢˜"
```

---

## 6. API è·¯ç”±

### 6.1 ç”¨æˆ·è®¤è¯ API

| è·¯ç”± | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/auth/register` | POST | ç”¨æˆ·æ³¨å†Œ |
| `/api/auth/[...nextauth]` | GET/POST | NextAuth è®¤è¯ |

### 6.2 ç®¡ç†å‘˜ API

| è·¯ç”± | æ–¹æ³• | è¯´æ˜ | éœ€è¦è®¤è¯ |
|------|------|------|----------|
| `/api/admin/login` | POST | ç®¡ç†å‘˜ç™»å½• | âŒ |
| `/api/admin/logout` | POST | ç®¡ç†å‘˜ç™»å‡º | âœ… |
| `/api/admin/profile` | GET/PUT | ç®¡ç†å‘˜æ¡£æ¡ˆ | âœ… |
| `/api/admin/stats` | GET | Dashboard ç»Ÿè®¡ | âœ… |
| `/api/admin/novels` | GET/POST | å°è¯´åˆ—è¡¨/ä¸Šä¼  | âœ… |
| `/api/admin/novels/[id]` | GET/PUT/DELETE | å°è¯´è¯¦æƒ…/ç¼–è¾‘/åˆ é™¤ | âœ… |
| `/api/admin/novels/[id]/ban` | POST | å°ç¦/è§£å°å°è¯´ | âœ… |
| `/api/admin/chapters` | POST | åˆ›å»ºç« èŠ‚ | âœ… |
| `/api/admin/chapters/[id]` | GET/PUT/DELETE | ç« èŠ‚è¯¦æƒ…/ç¼–è¾‘/åˆ é™¤ | âœ… |

### 6.3 ä¹¦æ¶ API

| è·¯ç”± | æ–¹æ³• | è¯´æ˜ | éœ€è¦è®¤è¯ |
|------|------|------|----------|
| `/api/library` | POST/DELETE | æ·»åŠ /ç§»é™¤ä¹¦æ¶ | âœ… |
| `/api/library/check` | GET | æ£€æŸ¥æ˜¯å¦åœ¨ä¹¦æ¶ | âœ… |

### 6.4 ç”¨æˆ·æ¡£æ¡ˆ API

| è·¯ç”± | æ–¹æ³• | è¯´æ˜ | éœ€è¦è®¤è¯ |
|------|------|------|----------|
| `/api/profile` | PUT | æ›´æ–°ç”¨æˆ·æ¡£æ¡ˆ | âœ… |
| `/api/profile/avatar` | POST | ä¸Šä¼ å¤´åƒ | âœ… |

### 6.5 é˜…è¯»è¿›åº¦ API

| è·¯ç”± | æ–¹æ³• | è¯´æ˜ | éœ€è¦è®¤è¯ |
|------|------|------|----------|
| `/api/reading-progress` | POST | ä¿å­˜é˜…è¯»è¿›åº¦ | âœ… |

### 6.6 æµè§ˆè¿½è¸ª API

| è·¯ç”± | æ–¹æ³• | è¯´æ˜ | éœ€è¦è®¤è¯ |
|------|------|------|----------|
| `/api/views/track` | POST | è¿½è¸ªå°è¯´æµè§ˆ | âŒ |

---

## 7. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 7.1 ç®¡ç†å‘˜åå°

**è®¤è¯æœºåˆ¶**:
- ç‹¬ç«‹äºç”¨æˆ·ç³»ç»Ÿ (å•ç‹¬ Admin è¡¨)
- ä½¿ç”¨ JWT + Cookie Session
- `src/lib/admin-auth.ts` æä¾›è®¤è¯å·¥å…·

**æ ¸å¿ƒåŠŸèƒ½**:
1. **Dashboard**: ç»Ÿè®¡æ•°æ®å±•ç¤º
2. **å°è¯´ç®¡ç†**:
   - æœç´¢å°è¯´ (æ ‡é¢˜/ä½œè€…)
   - ä¸Šä¼ æ–°å°è¯´
   - ç¼–è¾‘å°è¯´ä¿¡æ¯
   - å°ç¦/è§£å°å°è¯´
3. **ç« èŠ‚ç®¡ç†**:
   - æ·»åŠ ç« èŠ‚
   - ç¼–è¾‘ç« èŠ‚
   - åˆ é™¤ç« èŠ‚
4. **ä¸ªäººæ¡£æ¡ˆ**:
   - ä¿®æ”¹åå­—
   - ä¸Šä¼ åœ†å½¢å¤´åƒ (Base64)
   - ç¼–è¾‘ç®€ä»‹

**å…³é”®æ–‡ä»¶**:
- `src/lib/admin-auth.ts` - è®¤è¯å·¥å…·
- `src/app/admin/layout.tsx` - ç®¡ç†å‘˜å¸ƒå±€
- `src/components/admin/AdminHeader.tsx` - é¡¶éƒ¨å¯¼èˆª
- `src/components/admin/AdminSidebar.tsx` - ä¾§è¾¹æ 
- `src/components/admin/NovelSearchBar.tsx` - æœç´¢æ 

### 7.2 ä¹¦æ¶ç³»ç»Ÿ (Library)

**åŠŸèƒ½**:
- æ·»åŠ /ç§»é™¤å°è¯´åˆ°ä¹¦æ¶
- æŸ¥çœ‹ä¹¦æ¶åˆ—è¡¨
- æ˜¾ç¤ºé˜…è¯»è¿›åº¦
- ä»ä¹¦æ¶ç»§ç»­é˜…è¯»

**å®ç°**:
- Modal å½¢å¼å±•ç¤º
- æ”¯æŒæ¸¸å®¢å’Œç™»å½•ç”¨æˆ·
- æ¸¸å®¢ä½¿ç”¨ localStorage
- ç”¨æˆ·ä½¿ç”¨æ•°æ®åº“

**å…³é”®æ–‡ä»¶**:
- `src/components/shared/LibraryModal.tsx` - ä¹¦æ¶å¼¹çª—
- `src/components/library/MyLibrary.tsx` - ä¹¦æ¶å†…å®¹
- `src/app/api/library/route.ts` - ä¹¦æ¶ API

### 7.3 é˜…è¯»è¿›åº¦è¿½è¸ª

**åŠŸèƒ½**:
- è‡ªåŠ¨ä¿å­˜é˜…è¯»ä½ç½®
- è®°å½•æœ€åé˜…è¯»ç« èŠ‚
- ä»ä¸Šæ¬¡ä½ç½®ç»§ç»­

**å®ç°**:
- ChapterProgress è¡¨è®°å½•è¿›åº¦
- ReadingHistory è¡¨è®°å½•æœ€åç« èŠ‚
- å®¢æˆ·ç«¯è‡ªåŠ¨ä¿å­˜

**å…³é”®æ–‡ä»¶**:
- `src/components/reader/ChapterReader.tsx` - é˜…è¯»å™¨
- `src/app/api/reading-progress/route.ts` - è¿›åº¦ API
- `src/lib/view-tracker.ts` - æµè§ˆè¿½è¸ª

### 7.4 æµè§ˆé‡ç»Ÿè®¡

**åŠŸèƒ½**:
- è¿½è¸ªå°è¯´æµè§ˆé‡
- åŒºåˆ†ç”¨æˆ·å’Œæ¸¸å®¢
- é˜²æ­¢é‡å¤è®¡æ•° (24å°æ—¶å†…)

**å®ç°**:
- NovelView è¡¨è®°å½•
- guestId (IP + UserAgent hash)
- å®šæœŸæ¸…ç†æ—§æ•°æ®

**å…³é”®æ–‡ä»¶**:
- `src/lib/view-tracker.ts` - è¿½è¸ªå·¥å…·
- `src/components/ViewTracker.tsx` - å®¢æˆ·ç«¯ç»„ä»¶
- `src/app/api/views/track/route.ts` - API

### 7.5 å°ç¦ç³»ç»Ÿ

**åŠŸèƒ½**:
- å°ç¦/è§£å°å°è¯´
- ä¸´æ—¶å°ç¦ (æŒ‡å®šåˆ°æœŸæ—¶é—´)
- æ°¸ä¹…å°ç¦
- å°ç¦åŸå› è®°å½•

**å®ç°**:
- Novel è¡¨çš„ `isBanned`, `bannedUntil`, `banReason` å­—æ®µ
- å‰å°è‡ªåŠ¨è¿‡æ»¤è¢«å°ç¦å†…å®¹
- ç®¡ç†å‘˜å¯æŸ¥çœ‹å’Œç®¡ç†

**å…³é”®æ–‡ä»¶**:
- `src/components/admin/BanButton.tsx` - å°ç¦æŒ‰é’®
- `src/app/api/admin/novels/[id]/ban/route.ts` - å°ç¦ API

---

## 8. ç¼“å­˜ç­–ç•¥ â­ é‡è¦!

### 8.1 æ ¸å¿ƒåŸåˆ™

**å…³é”®ç†è§£: ISR vs Redis**

é¡¹ç›®ç»è¿‡æ·±åº¦ä¼˜åŒ–,ç¡®ç«‹äº†æ¸…æ™°çš„ç¼“å­˜ç­–ç•¥:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…¬å…±é¡µé¢ (Homepage, Category, Novels, å°è¯´è¯¦æƒ…)         â”‚
â”‚ âœ… ä½¿ç”¨: Next.js ISR (HTMLç¼“å­˜)                         â”‚
â”‚ âŒ ä¸ç”¨: Redisæ•°æ®ç¼“å­˜                                  â”‚
â”‚ åŸå› : ISRå·²ç¼“å­˜å®Œæ•´HTML,åŒé‡ç¼“å­˜æ˜¯å†—ä½™                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç‰¹å®šæ•°æ® (Library, Profile, API)                    â”‚
â”‚ âœ… ä½¿ç”¨: Redisç¼“å­˜                                      â”‚
â”‚ âŒ ä¸ç”¨: ISR (æ¯ä¸ªç”¨æˆ·æ•°æ®ä¸åŒ,æ— æ³•å…±äº«)                 â”‚
â”‚ åŸå› : å¿«é€Ÿå“åº”,å‡å°‘DBæŸ¥è¯¢                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ èšåˆæ•°æ® (Homepageé¦–é¡µæ•°æ®)                              â”‚
â”‚ âœ… ä½¿ç”¨: Redisç¼“å­˜ + ISR                                â”‚
â”‚ åŸå› : èšåˆå¤šä¸ªæ•°æ®æº,å‡å°‘DBå‹åŠ›                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 æˆæœ¬åˆ†æ

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡?**

```
Supabase (ä½ çš„æ•°æ®åº“):
âœ… æŸ¥è¯¢æ¬¡æ•°: æ— é™åˆ¶
âœ… æˆæœ¬: å‡ ä¹ä¸º0
âœ… æœ‰å®Œå–„çš„ç´¢å¼•ä¼˜åŒ–
â†’ ç»“è®º: å¤šç”¨DB,ä¸æ€•æŸ¥è¯¢

Upstash Redis:
âš ï¸ Commandsæœ‰é™åˆ¶ (å…è´¹10,000/å¤©)
âŒ æ¯æ¬¡GET/SETéƒ½è®¡æ•°
âŒ è¿™æ‰æ˜¯ç“¶é¢ˆæ‰€åœ¨
â†’ ç»“è®º: èŠ‚çº¦ä½¿ç”¨Redis
```

**è®¾è®¡å“²å­¦: è®©æ•°æ®åº“å¤šå¹²æ´»,è®©Rediså°‘å¹²æ´»!**

### 8.3 å®é™…åº”ç”¨

#### âœ… å…¬å…±é¡µé¢ - åªç”¨ISR

```typescript
// src/app/category/[slug]/page.tsx
export const revalidate = 1800  // 30åˆ†é’ŸISR

async function getCategoryWithNovels(slug: string) {
  // âŒ ä¸è¦ç”¨Redisç¼“å­˜!
  // return await getOrSet('category:xxx', async () => { ... })

  // âœ… ç›´æ¥æŸ¥DB,è®©ISRç¼“å­˜HTML
  const category = await prisma.category.findUnique({ where: { slug } })
  const novels = await prisma.$queryRaw`...`
  return { category, novels }
}

// å·¥ä½œåŸç†:
// ç¬¬1æ¬¡è®¿é—® â†’ æŸ¥DB â†’ æ¸²æŸ“HTML â†’ ISRç¼“å­˜30åˆ†é’Ÿ
// ç¬¬2-Næ¬¡ (30åˆ†é’Ÿå†…) â†’ ç›´æ¥è¿”å›ç¼“å­˜HTML (0 Redis, 0 DB!)
// 30åˆ†é’Ÿå â†’ é‡å¤ç¬¬1æ­¥
```

#### âœ… ç”¨æˆ·æ•°æ® - ç”¨Redis

```typescript
// src/app/api/library/route.ts
export async function GET(request: NextRequest) {
  const session = await auth()

  // âœ… ç”¨æˆ·ç‰¹å®šæ•°æ®,ç”¨Redisç¼“å­˜
  const novels = await getOrSet(
    CacheKeys.USER_LIBRARY(session.user.id),
    async () => {
      return await prisma.library.findMany({
        where: { userId: session.user.id }
      })
    },
    CacheTTL.USER_LIBRARY
  )

  return NextResponse.json({ novels })
}

// å·¥ä½œåŸç†:
// - æ¯ä¸ªç”¨æˆ·æ•°æ®ä¸åŒ,æ— æ³•ç”¨ISR
// - Redis 5åˆ†é’ŸTTL,å¿«é€Ÿå“åº”
```

#### âœ… èšåˆæ•°æ® - Redis + ISR

```typescript
// src/lib/cache-optimized.ts
export async function getHomePageData(): Promise<HomePageData> {
  // âœ… é¦–é¡µèšåˆå¤šä¸ªæ•°æ®æº,ç”¨Rediså‡å°‘DBå‹åŠ›
  return await getOrSet(
    'home:all-data',
    async () => {
      // èšåˆ: featured novels + all categories + stats
      const [featured, categories, stats] = await Promise.all([
        prisma.novel.findMany({ where: { isFeatured: true } }),
        prisma.category.findMany(),
        getStats()
      ])
      return { featured, categories, stats }
    },
    CacheTTL.HOME_FEATURED  // 1å°æ—¶
  )
}

// å·¥ä½œåŸç†:
// - Redisç¼“å­˜æ•°æ® (1å°æ—¶)
// - ISRç¼“å­˜HTML (1å°æ—¶)
// - åŒé‡ç¼“å­˜ä¿æŠ¤DB
```

### 8.4 ä¼˜åŒ–æ•ˆæœ

| é¡µé¢ç±»å‹ | ä¹‹å‰ | ç°åœ¨ | é™ä½ |
|---------|------|------|------|
| Categoryé¡µé¢ | 1440æ¬¡Redis/å¤© | 0æ¬¡ | -100% |
| Novelsåˆ—è¡¨ | 96æ¬¡/å¤© | 0æ¬¡ | -100% |
| å°è¯´è¯¦æƒ… | 960æ¬¡/å¤© | 0æ¬¡ | -100% |
| é¦–é¡µ | 50æ¬¡/å¤© | 50æ¬¡/å¤© | - |
| Library API | 200æ¬¡/å¤© | 200æ¬¡/å¤© | - |
| **æ€»è®¡** | **2746æ¬¡/å¤©** | **250æ¬¡/å¤©** | **-91%** |

### 8.5 å¼€å‘æ³¨æ„äº‹é¡¹

**æ·»åŠ æ–°é¡µé¢æ—¶,é—®è‡ªå·±:**

1. **è¿™æ˜¯å…¬å…±é¡µé¢å—?** (æ‰€æœ‰ç”¨æˆ·çœ‹åˆ°ç›¸åŒå†…å®¹)
   - YES â†’ åªç”¨ISR,ä¸ç”¨Redis
   - NO â†’ ç»§ç»­ä¸‹ä¸€æ­¥

2. **è¿™æ˜¯ç”¨æˆ·ç‰¹å®šæ•°æ®å—?** (æ¯ä¸ªç”¨æˆ·ä¸åŒ)
   - YES â†’ ç”¨Redisç¼“å­˜
   - NO â†’ ç»§ç»­ä¸‹ä¸€æ­¥

3. **è¿™æ˜¯èšåˆå¤šä¸ªæ•°æ®æºå—?**
   - YES â†’ Redis + ISR
   - NO â†’ åªç”¨ISR

**å…³é”®æ–‡ä»¶:**
- `src/lib/cache.ts` - Redisç¼“å­˜å·¥å…·
- `src/lib/cache-optimized.ts` - é¦–é¡µæ•°æ®ç¼“å­˜
- `src/lib/redis-monitor.ts` - Redisç›‘æ§ç³»ç»Ÿ
- `src/app/api/redis-monitor/route.ts` - ç›‘æ§API

**ç›‘æ§Redisä½¿ç”¨:**
```bash
# æŸ¥çœ‹Redisç»Ÿè®¡
GET /api/redis-monitor?action=stats

# æŸ¥çœ‹è°ƒç”¨æ—¥å¿—
GET /api/redis-monitor?action=logs&limit=100
```

---

## 9. å¸¸è§ä»»åŠ¡å‚è€ƒ

### 9.1 æ·»åŠ æ–°çš„ API è·¯ç”±

```typescript
// src/app/api/my-route/route.ts
import { NextRequest, NextResponse } from 'next/server'
import { prisma } from '@/lib/prisma'

export async function GET(request: NextRequest) {
  try {
    const data = await prisma.novel.findMany()
    return NextResponse.json({ success: true, data })
  } catch (error) {
    return NextResponse.json(
      { success: false, error: 'Failed to fetch' },
      { status: 500 }
    )
  }
}
```

### 9.2 åˆ›å»ºæ–°é¡µé¢

```typescript
// src/app/my-page/page.tsx
import { prisma } from '@/lib/prisma'

export default async function MyPage() {
  const data = await prisma.novel.findMany()

  return (
    <div className="container mx-auto py-12">
      <h1 className="text-3xl font-bold mb-8">My Page</h1>
      {/* å†…å®¹ */}
    </div>
  )
}
```

### 9.3 æ·»åŠ ç®¡ç†å‘˜é¡µé¢

éœ€è¦åŒ…å«è®¤è¯æ£€æŸ¥:

```typescript
// src/app/admin/my-page/page.tsx
import { getAdminSession } from '@/lib/admin-auth'
import { redirect } from 'next/navigation'

export default async function AdminPage() {
  const session = await getAdminSession()
  if (!session) {
    redirect('/admin-login')
  }

  return <div>Admin Content</div>
}
```

### 9.4 æ•°æ®åº“è¿ç§»

```bash
# 1. ä¿®æ”¹ prisma/schema.prisma
# 2. ç”Ÿæˆ Prisma Client
npm run db:generate

# 3. æ¨é€åˆ°æ•°æ®åº“ (å¼€å‘ç¯å¢ƒ)
npm run db:push

# 4. æ£€æŸ¥
npm run db:studio
```

### 9.5 ä¸Šä¼ å›¾ç‰‡åˆ° Cloudinary

```typescript
// src/lib/cloudinary.ts
import { v2 as cloudinary } from 'cloudinary'

export async function uploadImage(file: File, folder: string) {
  const arrayBuffer = await file.arrayBuffer()
  const buffer = Buffer.from(arrayBuffer)

  return new Promise((resolve, reject) => {
    cloudinary.uploader.upload_stream(
      { folder, resource_type: 'image' },
      (error, result) => {
        if (error) reject(error)
        else resolve(result)
      }
    ).end(buffer)
  })
}
```

### 9.6 åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·

```bash
# ä½¿ç”¨è„šæœ¬åˆ›å»º
npm run db:seed-admin

# æˆ–æ‰‹åŠ¨åœ¨ Prisma Studio ä¸­åˆ›å»º
npm run db:studio
# å¯†ç éœ€è¦ä½¿ç”¨ bcrypt åŠ å¯†
```

---

## 10. ç¯å¢ƒå˜é‡

### 10.1 å¿…éœ€çš„ç¯å¢ƒå˜é‡

```bash
# .env.local

# æ•°æ®åº“
DATABASE_URL="postgresql://..."

# NextAuth (ç”¨æˆ·è®¤è¯)
AUTH_SECRET="your-nextauth-secret"  # openssl rand -base64 32
NEXTAUTH_URL="http://localhost:3000"

# Cloudinary (å›¾ç‰‡å­˜å‚¨)
NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME="your-cloud-name"
CLOUDINARY_API_KEY="your-api-key"
CLOUDINARY_API_SECRET="your-api-secret"

# ç®¡ç†å‘˜ JWT
ADMIN_JWT_SECRET="your-admin-jwt-secret"  # openssl rand -base64 32
```

### 10.2 å¯é€‰çš„ç¯å¢ƒå˜é‡

```bash
# Google OAuth (å¦‚æœä½¿ç”¨)
GOOGLE_CLIENT_ID="..."
GOOGLE_CLIENT_SECRET="..."

# å¼€å‘æ¨¡å¼
NODE_ENV="development"
```

---

## 11. å·²å®ŒæˆåŠŸèƒ½

### 11.1 MVP æ ¸å¿ƒåŠŸèƒ½ âœ…

- [x] **ç”¨æˆ·ç³»ç»Ÿ**
  - [x] æ³¨å†Œ/ç™»å½•
  - [x] Google OAuth
  - [x] ç”¨æˆ·æ¡£æ¡ˆ
  - [x] å¤´åƒä¸Šä¼ 

- [x] **ç®¡ç†å‘˜åå°**
  - [x] ç‹¬ç«‹ç™»å½•ç³»ç»Ÿ
  - [x] Dashboard ç»Ÿè®¡
  - [x] å°è¯´æœç´¢
  - [x] å°è¯´ä¸Šä¼ 
  - [x] å°è¯´ç¼–è¾‘
  - [x] ç« èŠ‚ç®¡ç†
  - [x] å°ç¦åŠŸèƒ½
  - [x] ä¸ªäººæ¡£æ¡ˆç¼–è¾‘
  - [x] åœ†å½¢å¤´åƒä¸Šä¼ 

- [x] **è¯»è€…åŠŸèƒ½**
  - [x] é¦–é¡µå±•ç¤º
  - [x] åˆ†ç±»æµè§ˆ
  - [x] å°è¯´è¯¦æƒ…é¡µ
  - [x] ç« èŠ‚é˜…è¯»å™¨
  - [x] ä¹¦æ¶ç³»ç»Ÿ (Library Modal)
  - [x] é˜…è¯»è¿›åº¦è¿½è¸ª
  - [x] æµè§ˆé‡ç»Ÿè®¡
  - [x] ç‚¹èµåŠŸèƒ½

- [x] **æ€§èƒ½ä¼˜åŒ–**
  - [x] å›¾ç‰‡æ‡’åŠ è½½
  - [x] æ•°æ®åº“ç´¢å¼•
  - [x] ç»„ä»¶ä»£ç åˆ†å‰²
  - [x] é˜²æŠ–æœç´¢

### 11.2 å¾…å¼€å‘åŠŸèƒ½ â³

- [ ] **è¯„è®ºç³»ç»Ÿ**
  - [ ] å‘å¸ƒè¯„è®º
  - [ ] æ˜¾ç¤ºè¯„è®ºåˆ—è¡¨
  - [ ] åˆ é™¤è‡ªå·±çš„è¯„è®º

- [ ] **ä½œå®¶æ¨¡å¼** (åæœŸ)
  - [ ] ä½œå®¶å¼•å¯¼é¡µ
  - [ ] åˆ›å»ºå°è¯´
  - [ ] ç®¡ç†è‡ªå·±çš„ä½œå“

- [ ] **ç¤¾åŒºåŠŸèƒ½** (åæœŸ)
  - [ ] ä¹¦è’æ±‚åŠ©å¸–
  - [ ] ä¹¦å•æ¨è
  - [ ] æ‹¯æ•‘ä¹¦è’ç»Ÿè®¡

- [ ] **ç§ä¿¡ç³»ç»Ÿ** (åæœŸ)

- [ ] **æ ‡ç­¾ç³»ç»Ÿ** (åæœŸ)

---

## ğŸš¨ é‡è¦æé†’

### å¼€å‘å‰å¿…è¯»

1. **ç®¡ç†å‘˜è®¤è¯**:
   - ç®¡ç†å‘˜ç³»ç»Ÿç‹¬ç«‹äºç”¨æˆ·ç³»ç»Ÿ
   - ä½¿ç”¨ `getAdminSession()` æ£€æŸ¥è®¤è¯
   - ç™»å½•è·¯ç”±: `/admin-login`

2. **å›¾ç‰‡ä¸Šä¼ **:
   - ä½¿ç”¨ Cloudinary
   - è®°å½• `publicId` ç”¨äºåˆ é™¤
   - å¤´åƒé™åˆ¶: 5MB, æ­£æ–¹å½¢è£å‰ª

3. **æ•°æ®åº“æ“ä½œ**:
   - æ€»æ˜¯ä½¿ç”¨ Prisma Client
   - æ³¨æ„ç´¢å¼•æ€§èƒ½
   - Cascade åˆ é™¤å…³ç³»

4. **é”™è¯¯å¤„ç†**:
   - API è¿”å›ç»Ÿä¸€æ ¼å¼
   - ä½¿ç”¨ Toast æç¤ºç”¨æˆ·
   - è®°å½•é”™è¯¯æ—¥å¿—

5. **æ€§èƒ½è€ƒè™‘**:
   - åˆ†é¡µæŸ¥è¯¢ (pageSize: 20)
   - å›¾ç‰‡å‹ç¼©
   - æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

---

## ğŸ“ å¼€å‘å»ºè®®

### Claude ä½¿ç”¨è¿™ä¸ªæ–‡æ¡£æ—¶

1. **å¼€å§‹ä»»åŠ¡å‰**:
   - æ£€æŸ¥ç›¸å…³æ¨¡å—çš„æ–‡ä»¶ä½ç½®
   - äº†è§£æ•°æ®åº“è¡¨ç»“æ„
   - æŸ¥çœ‹ API è·¯ç”±çº¦å®š

2. **å®ç°æ–°åŠŸèƒ½æ—¶**:
   - å‚è€ƒå·²æœ‰çš„ç±»ä¼¼åŠŸèƒ½
   - éµå¾ªä»£ç è§„èŒƒ
   - æ›´æ–°æœ¬æ–‡æ¡£

3. **è°ƒè¯•é—®é¢˜æ—¶**:
   - æ£€æŸ¥ç¯å¢ƒå˜é‡
   - æŸ¥çœ‹æ•°æ®åº“ç»“æ„
   - ç¡®è®¤è®¤è¯çŠ¶æ€

4. **æäº¤ä»£ç å‰**:
   - æµ‹è¯•åŠŸèƒ½å®Œæ•´æ€§
   - æ£€æŸ¥é”™è¯¯å¤„ç†
   - æ›´æ–°æ–‡æ¡£

---

**æ–‡æ¡£ç»´æŠ¤**: æ¯æ¬¡é‡å¤§åŠŸèƒ½æ›´æ–°å,è¯·åŒæ­¥æ›´æ–°æœ¬æ–‡æ¡£
**æœ€åæ›´æ–°**: 2025-11-11
**ç»´æŠ¤è€…**: Claude + Leo

**ğŸ¦‹ è®©é˜…è¯»æ›´è½»æ¾,è®©åˆ›ä½œæ›´ç®€å•**
