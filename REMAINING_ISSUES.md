# å‰©ä½™é—®é¢˜åˆ—è¡¨

## âœ… å·²ä¿®å¤

### 1. æ®µè½è¯„è®ºæ— é™å¾ªçŽ¯ï¼ˆå·²ä¿®å¤ âœ…ï¼‰
- **é—®é¢˜**ï¼š40+æ¬¡å¹¶å‘è¯·æ±‚å¯¼è‡´è¿žæŽ¥æ± è€—å°½
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ‰¹é‡APIï¼Œä¸€æ¬¡è¯·æ±‚èŽ·å–æ‰€æœ‰æ®µè½è¯„è®ºæ•°
- **æ•ˆæžœ**ï¼šAPIè¯·æ±‚ â†“97.5%ï¼Œè¿žæŽ¥æ± ä½¿ç”¨ >100% â†’ <5%

### 2. é˜…è¯»å™¨ç‚¹èµžé”™è¯¯ï¼ˆå·²ä¿®å¤ âœ…ï¼‰
- **é—®é¢˜**ï¼š`TypeError: Cannot read properties of undefined (reading 'likeCount')`
- **æ ¹æœ¬åŽŸå› **ï¼šAPIè¿”å›žå¼‚å¸¸æ•°æ®æ—¶å‰ç«¯å´©æºƒ
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ·»åŠ æ•°æ®éªŒè¯ï¼Œç¡®ä¿ `data.likeCount` å’Œ `data.liked` å­˜åœ¨
- **æ•ˆæžœ**ï¼šä¸å†å´©æºƒï¼Œæœ‰è¯¦ç»†é”™è¯¯æ—¥å¿—

### 3. Redis ç¼“å­˜æœªå‡ºçŽ°ï¼ˆå·²ä¿®å¤ âœ…ï¼‰
- **é—®é¢˜**ï¼šé¦–é¡µåˆ·æ–°å¤šæ¬¡ï¼ŒUpstash Data Browser æ²¡æœ‰ `home:all-data` ç¼“å­˜
- **æ ¹æœ¬åŽŸå› **ï¼š`fetchCache = 'force-cache'` é˜»æ­¢äº† Redis SET æ“ä½œ
- **è¯¦ç»†åˆ†æž**ï¼š
  1. `force-cache` ç¼“å­˜æ‰€æœ‰ fetchï¼ˆåŒ…æ‹¬ Upstash Redis HTTP è¯·æ±‚ï¼‰
  2. ç¬¬ä¸€æ¬¡æž„å»ºï¼šRedis GET â†’ MISS â†’ Next.js ç¼“å­˜è¿™ä¸ª"MISS"ç»“æžœ
  3. Redis SET è¢«è·³è¿‡ï¼ˆå› ä¸º fetch è¢«ç¼“å­˜ï¼‰
  4. åŽç»­è¯·æ±‚ç”¨ Next.js ç¼“å­˜çš„ç»“æžœï¼Œæ°¸è¿œä¸è°ƒç”¨ Redis
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ”¹ç”¨ `dynamic = 'force-dynamic'`
- **æ•ˆæžœ**ï¼š
  - âœ… é¦–é¡µæ¯æ¬¡è¯·æ±‚éƒ½æ‰§è¡Œ
  - âœ… Redis ç¼“å­˜æ­£å¸¸å·¥ä½œ
  - âœ… ç¬¬ä¸€æ¬¡è®¿é—®å†™å…¥ç¼“å­˜ï¼Œç¬¬äºŒæ¬¡è®¿é—®å‘½ä¸­ç¼“å­˜

### 4. Writer Dashboard - Recent Stories æ›´æ–°ä¸åŠæ—¶ï¼ˆå·²ä¿®å¤ âœ…ï¼‰
- **é—®é¢˜**ï¼šå·²ä¸Šä¼ çš„å°è¯´åœ¨ Dashboard ä¸æ˜¾ç¤º
- **æ ¹æœ¬åŽŸå› **ï¼šDashboard é¡µé¢æ²¡æœ‰è¢« revalidate å½“å°è¯´/ç« èŠ‚ CRUD æ“ä½œå‘ç”Ÿæ—¶
- **è§£å†³æ–¹æ¡ˆ**ï¼š
  1. æ·»åŠ  `dynamic = 'force-dynamic'` åˆ° Dashboard é¡µé¢
  2. æ‰©å±• `invalidateNovelRelatedCache()` å‡½æ•°æ·»åŠ  `/dashboard` revalidation
  3. åœ¨æ‰€æœ‰ç« èŠ‚ CRUD endpoints æ·»åŠ ç¼“å­˜ invalidation
- **æ•ˆæžœ**ï¼š
  - âœ… Dashboard ç«‹å³æ›´æ–°å½“å°è¯´è¢«åˆ›å»º/æ›´æ–°/åˆ é™¤
  - âœ… ç« èŠ‚æ“ä½œä¹Ÿè§¦å‘ Dashboard åˆ·æ–°
  - âœ… ç»Ÿè®¡æ•°æ®ï¼ˆç« èŠ‚æ•°ã€å­—æ•°ï¼‰å®žæ—¶æ›´æ–°

### 5. å®˜æ–¹è´¦å· (ButterPicks) é—®é¢˜ï¼ˆå·²ä¿®å¤ âœ…ï¼‰
- **é—®é¢˜**ï¼šå®˜æ–¹è´¦å·ç¼ºå°‘ç‰¹æ®Šæ ‡è¯†å’Œæ ·å¼
- **æ ¹æœ¬åŽŸå› **ï¼šä»£ç å·²æ”¯æŒä½†æ•°æ®åº“ `isOfficial` flag æœªè®¾ç½®
- **è§£å†³æ–¹æ¡ˆ**ï¼š
  1. åˆ›å»º `scripts/set-official-account.ts` è„šæœ¬è®¾ç½® flag
  2. `AuthorNameButton` ç»„ä»¶æ·»åŠ  inline "Official" badge æ˜¾ç¤º
  3. æ–‡æ¡£åŒ–è®¾ç½®æµç¨‹ (`OFFICIAL_ACCOUNT_SETUP.md`)
- **æ•ˆæžœ**ï¼ˆéœ€è¦åœ¨ç”Ÿäº§çŽ¯å¢ƒè¿è¡Œè„šæœ¬ï¼‰ï¼š
  - âœ… å°è¯´è¯¦æƒ…é¡µä½œè€…åæ—æ˜¾ç¤º "Official" badgeï¼ˆè“è‰²gradientï¼‰
  - âœ… ç‚¹å‡»ä½œè€…åæ‰“å¼€ modal æ˜¾ç¤ºå®˜æ–¹å¡ç‰‡
  - âœ… Avatar æœ‰è“/é‡‘æ¸å˜è¾¹æ¡†å’Œå‘å…‰æ•ˆæžœ
  - âœ… å¤´åƒä¸‹æ˜¾ç¤º "Official Account" è€Œä¸æ˜¯ç­‰çº§å
  - âœ… Modal åªæ˜¾ç¤º Followers ç»Ÿè®¡ï¼ˆéšè— Following/Books Readï¼‰
  - âœ… åªæ˜¾ç¤º Novels tabï¼ˆéšè— Library/History/Reviewsï¼‰
- **éƒ¨ç½²æ­¥éª¤**ï¼šè¿è¡Œ `npx tsx scripts/set-official-account.ts` åœ¨ç”Ÿäº§çŽ¯å¢ƒ

---

## ðŸ”§ å¾…ä¿®å¤

### 6. åˆ†é¡µé—®é¢˜
- [ ] Profile ç›¸å…³çš„ library åº”è¯¥åˆ†é¡µ
- [ ] Reading history åº”è¯¥åˆ†é¡µ

---

## ä¼˜å…ˆçº§

1. **P0ï¼ˆä¸¥é‡ï¼‰** - âœ… å·²å…¨éƒ¨ä¿®å¤
2. **P1ï¼ˆé«˜ï¼‰** - âœ… å·²å…¨éƒ¨ä¿®å¤
3. **P2ï¼ˆä¸­ï¼‰** - âœ… å·²å…¨éƒ¨ä¿®å¤ï¼ˆWriter dashboardã€å®˜æ–¹è´¦å·ï¼‰
4. **P3ï¼ˆä½Žï¼‰** - åˆ†é¡µ

---

## éƒ¨ç½²åŽéªŒè¯

éƒ¨ç½²åŽæ£€æŸ¥ Vercel æ—¥å¿—åº”è¯¥çœ‹åˆ°ï¼š

```
[Redis GET] Fetching key: home:all-data
[Redis GET] Cache MISS (home:all-data)
[Redis SET] Writing key: home:all-data, TTL: 3600
[Redis SET] Success (home:all-data)

// ç¬¬äºŒæ¬¡è®¿é—®ï¼š
[Redis GET] Fetching key: home:all-data
[Redis GET] Cache HIT (home:all-data)
```

æ£€æŸ¥ Upstash Data Browser åº”è¯¥çœ‹åˆ°ï¼š
- âœ… Key: `home:all-data`
- âœ… TTL: çº¦ 3600 ç§’ï¼ˆ1å°æ—¶ï¼‰
